#!/usr/bin/env bash

# Check if LibreOffice is installed
if ! command -v libreoffice &> /dev/null; then
    notify-send "LibreOffice is not installed. Please install it to use this script."
    exit 1
fi

# Loop through all selected files
for file in "$@"; do
    # Get the directory and filename without extension
    dir=$(dirname "$file")
    filename=$(basename "$file")
    name="${filename%.*}"

    # Convert the file to PDF
    if libreoffice --headless --convert-to pdf "$file" --outdir "$dir"; then
        echo "Converted $file to $dir/$name.pdf"
    else
        notify-send "Failed to convert $file to PDF"
    fi
done

# Show completion message
notify-send "Conversion complete!"
